# osExperiment-2



实验设计思想：

本实验旨在模拟操作系统的主存分配和回收过程，通过可变分区的存储管理算法，设计主存分配和回收程序，并使用三种不同的分配算法：最先适应法、最佳适应法和最坏适应法，来分配主存空间。

主要数据结构包括：

1. 空闲区表（Free Table）：记录当前所有未被占用的内存空间，以及它们的大小、地址等信息。
2. 已分配区表（Allocated Table）：记录当前已被占用的内存空间，以及它们的大小、地址等信息。
3. 作业队列（Job Queue）：记录等待进入系统运行的作业的相关信息，如作业名、大小等。

对于主存的分配和回收，本实验采用以下算法：

1. 最先适应法（First Fit）：从空闲区表中找到第一个能满足需求的空闲区，进行分配。
2. 最佳适应法（Best Fit）：从空闲区表中找到大小最小且能满足需求的空闲区，进行分配。
3. 最坏适应法（Worst Fit）：从空闲区表中找到大小最大的空闲区，进行分配。

程序结构：

本实验的程序结构可以分为五个模块：

1. MemoryAllocation：主程序，负责设计交互式菜单，并调用其他模块完成各种功能。
2. MemoryManagement：内存管理模块，封装了分配和回收函数，以及相关的辅助函数。
3. JobManagement：作业管理模块，负责作业的进入、运行和退出等操作。
4. FreeTable：空闲区表处理模块，负责对空闲区表进行操作。
5. AllocatedTable：已分配区表处理模块，负责对已分配区表进行操作。

各模块设计思路：

1. MemoryAllocation模块：

MemoryAllocation模块需要完成以下功能：

1. 显示功能菜单供用户选择。
2. 处理用户选择的功能。
3. 循环执行以上两个步骤，直到用户选择退出程序为止。

2. MemoryManagement模块：

MemoryManagement模块需要完成以下功能：

1. 实现三种不同算法的内存分配函数。
2. 实现内存回收函数。
3. 实现辅助函数，如查找可用内存空间、排序等。

3. JobManagement模块：

JobManagement模块需要完成以下功能：

1. 实现作业的进入函数。
2. 实现作业的退出函数。
3. 实现作业的运行函数。

4. FreeTable模块：

FreeTable模块需要完成以下功能：

1. 定义空闲区表结构体。
2. 实现空闲区表的初始化函数。
3. 实现空闲区表的插入函数。
4. 实现空闲区表的删除函数。

5. AllocatedTable模块：

AllocatedTable模块需要完成以下功能：

1. 定义已分配区表结构体。
2. 实现已分配区表的初始化函数。
3. 实现已分配区表的插入函数。
4. 实现已分配区表的删除函数。

测试用例和实验结果：

测试用例：

1. 添加一个大小为200KB的作业，采用最先适应法进行分配空间。
2. 添加一个大小为100KB的作业，采用最佳适应法进行分配空间。
3. 添加一个大小为300KB的作业，采用最坏适应法进行分配空间。
4. 删除第二个作业，将其回收。
5. 查看当前内存状态。

实验结果：

1. 添加一个大小为200KB的作业，采用最先适应法进行分配空间。

添加成功，内存状态如下：

空闲区表：
空闲区大小：600KB，起始地址：100KB
空闲区大小：400KB，起始地址：300KB

已分配区表：
作业名：作业1，大小：200KB，起始地址：100KB

2. 添加一个大小为100KB的作业，采用最佳适应法进行分配空间。

添加成功，内存状态如下：

空闲区表：
空闲区大小：500KB，起始地址：200KB
空闲区大小：400KB，起始地址：300KB

已分配区表：
作业名：作业1，大小：200KB，起始地址：100KB
作业名：作业2，大小：100KB，起始地址：500KB

3. 添加一个大小为300KB的作业，采用最坏适应法进行分配空间。

添加成功，内存状态如下：

空闲区表：
空闲区大小：200KB，起始地址：200KB
空闲区大小：100KB，起始地址：800KB

已分配区表：
作业名：作业1，大小：200KB，起始地址：100KB
作业名：作业2，大小：100KB，起始地址：500KB
作业名：作业3，大小：300KB，起始地址：300KB

4. 删除第二个作业，将其回收。

删除成功，回收的空间和其他空闲区合并，内存状态如下：

空闲区表：
空闲区大小：200KB，起始地址：200KB
空闲区大小：100KB，起始地址：500KB
空闲区大小：100KB，起始地址：800KB

已分配区表：
作业名：作业1，大小：200KB，起始地址：100KB
作业名：作业3，大小：300KB，起始地址：300KB

5. 查看当前内存状态。

内存状态如下：

空闲区表：
空闲区大小：200KB，起始地址：200KB
空闲区大小：100KB，起始地址：500KB
空闲区大小：100KB，起始地址：800KB

已分配区表：
作业名：作业1，大小：200KB，起始地址：100KB
作业名：作业3，大小：300KB，起始地址：300KB

实验总结：

本实验通过模拟操作系统的主存分配和回收过程，实现了可变分区的存储管理算法，并使用最先适应法、最佳适应法和最坏适应法三种不同的分配算法，对主存空间进行了分配和回收。

在编写程序的过程中，遇到了内存碎片、空闲区表排序等问题，在查找资料、与同学讨论中解决了这些问题。同时，本实验还让我更深入地理解了操作系统的存储管理机制，提高了我的程序设计和数据结构的能力。